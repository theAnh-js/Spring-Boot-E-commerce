var buttonLoadForState;
var dropDownCountryForState;
var dropDownState;

/*var buttonAddCountry;
var buttonUpdateCountry;
var buttonDeleteCountry;
var labelCountryName;
var fieldCountryName;
var fieldCountryCode;
var selectedCountryName;*/


$(document).ready(function(){
	buttonLoadForState = $("#buttonLoadCountriesForState");
	dropDownCountryForState = $("#dropDownCountriesForState");
	dropDownState = $("#dropDownStates");
	
	/*buttonAddCountry =$("#buttonAddCountry");
	buttonUpdateCountry = $("#buttonUpdateCountry");
	buttonDeleteCountry = $("#buttonDeleteCountry");
	labelCountryName = $("#labelCountryName");
	fieldCountryName = $("#fieldCountryName");
	fieldCountryCode = $("#fieldCountryCode");*/
	
	
	buttonLoadForState.click(function(){
		loadCountries();
	});
	
	dropDownCountryForState.on("change", function(){
		changeFormStateSelectedCountry();
	});
	
	//////////////////////////////////////////
	buttonAddCountry.click(function(){
		if(buttonAddCountry.val() == "Add"){
			addCountry();
		}else{
			changeFormStateToNew();
		}		
	});
	
	buttonUpdateCountry.click(function(){
		updateCountry();
	});
	
	buttonDeleteCountry.click(function(){
		deleteCountry();
	});
	
	
});

function changeFormStateSelectedCountry(){
/*	buttonAddCountry.prop("value", "New");
	buttonUpdateCountry.prop("disabled", false);
	buttonDeleteCountry.prop("disabled", false);
	
	labelCountryName.text("Selected Country:")
	selectedCountryName = $("#dropDownCountries option:selected").text();
	fieldCountryName.val(selectedCountryName);
	
	countryCode = dropDownCountry.val().split("-")[1];
	fieldCountryCode.val(countryCode);*/
	
	countryId = dropDownCountryForState.val().split("-")[0];
	url = contextPath + "states/" + countryId;
	
	$.get(url, function(responseJSON){
		dropDownState.empty();
		
		$.each(responseJSON, function(state){	
			optionValue = state.id;
			$("<option>").val(optionValue).text(state.name).appendTo(dropDownState);
		});
	}).done(function(){
		buttonLoad.val("Refresh Country List");
		showToastMessage("All countries have been load");
	}).fail(function(){
		showToastMessage("ERROR: Could not connect to server or server encountered an error")
	});
		
}

function loadCountries(){
	url = contextPath + "countries/list";
	
	$.get(url, function(responseJSON){
		dropDownCountryForState.empty();
		
		$.each(responseJSON, function(index, country){	
			optionValue = country.id + "-" + country.code;
			$("<option>").val(optionValue).text(country.name).appendTo(dropDownCountryForState);
		});
	}).done(function(){
		buttonLoad.val("Refresh Country List");
		showToastMessage("All countries have been load");
	}).fail(function(){
		showToastMessage("ERROR: Could not connect to server or server encountered an error")
	});
	
}

function showToastMessage(message){
	$("#toastMessage").text(message);
	$(".toast").toast('show');
}